---
- hosts: localhost
  vars:
    container_name: check-yum-update-repo-disabled
  tasks:

  - include: tasks/create-test-container.yml

  - name: disable the local yum repo
    delegate_to: "{{ container_name }}"
    replace: dest=/etc/yum.repos.d/local.repo backup=no
             regexp='^enabled=1'
             replace='enabled=0'

  - name: test should succeed; nothing blocks a yum update
    delegate_to: "{{ container_name }}"
    action: check_yum_update

  - include: tasks/delete-test-container.yml
